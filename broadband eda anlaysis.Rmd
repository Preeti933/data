---
title: "Broadband Speed Analysis"
author: "Generated by ChatGPT"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Required Libraries
```{r}
library(ggplot2)
library(dplyr)
```

## Load the Data
```{r}
data <- read.csv("broadband_with_lsoa.csv", stringsAsFactors = FALSE)

# Rename columns to standard format
colnames(data) <- gsub("\\.", "_", colnames(data))

# Ensure correct column names by explicitly renaming relevant ones
data <- data %>% rename(
  average_download_speed_mbit_s = average_download_speed__mbit_s_,
  maximum_download_speed_mbit_s = maximum_download_speed__mbit_s_
)
```

## Filter Data for Devon and Dorset
```{r}
devon_districts <- c("EX", "PL")
dorset_districts <- c("DT")

devon_data <- data %>% filter(postcode_area %in% devon_districts)
dorset_data <- data %>% filter(postcode_area %in% dorset_districts)
```

## Average and Maximum Speeds for Devon and Dorset by District
```{r}
district_summary <- data %>% 
  group_by(postcode_area) %>% 
  summarise(
    avg_speed = mean(average_download_speed_mbit_s, na.rm = TRUE),
    max_speed = max(maximum_download_speed_mbit_s, na.rm = TRUE)
  )

ggplot(district_summary, aes(x = postcode_area, y = avg_speed, fill = postcode_area)) + 
  geom_bar(stat = "identity") + 
  labs(title = "Average Broadband Speed by District", x = "District", y = "Average Speed (Mbps)") +
  theme_minimal()
```

## Bar Chart for Average Speed in Devon
```{r}
ggplot(devon_data, aes(x = postcode_area, y = average_download_speed_mbit_s, fill = postcode_area)) + 
  geom_bar(stat = "summary", fun = mean) + 
  labs(title = "Average Broadband Speed in Devon", x = "District", y = "Average Speed (Mbps)") +
  theme_minimal()
```

## Bar Chart for Average Speed in Dorset
```{r}
ggplot(dorset_data, aes(x = postcode_area, y = average_download_speed_mbit_s, fill = postcode_area)) + 
  geom_bar(stat = "summary", fun = mean) + 
  labs(title = "Average Broadband Speed in Dorset", x = "District", y = "Average Speed (Mbps)") +
  theme_minimal()
```

## Bar Chart for Average and Maximum Speed in Devon by District
```{r}
devon_summary <- devon_data %>% 
  group_by(postcode_area) %>% 
  summarise(
    avg_speed = mean(average_download_speed_mbit_s, na.rm = TRUE),
    max_speed = max(maximum_download_speed_mbit_s, na.rm = TRUE)
  )

ggplot(devon_summary, aes(x = postcode_area)) +
  geom_bar(aes(y = avg_speed, fill = "Average Speed"), stat = "identity", position = "dodge") +
  geom_bar(aes(y = max_speed, fill = "Maximum Speed"), stat = "identity", position = "dodge") +
  labs(title = "Broadband Speeds in Devon by District", x = "District", y = "Speed (Mbps)") +
  scale_fill_manual(values = c("Average Speed" = "blue", "Maximum Speed" = "red")) +
  theme_minimal()
```

## Bar Chart for Average and Maximum Speed in Dorset by District
```{r}
dorset_summary <- dorset_data %>% 
  group_by(postcode_area) %>% 
  summarise(
    avg_speed = mean(average_download_speed_mbit_s, na.rm = TRUE),
    max_speed = max(maximum_download_speed_mbit_s, na.rm = TRUE)
  )

ggplot(dorset_summary, aes(x = postcode_area)) +
  geom_bar(aes(y = avg_speed, fill = "Average Speed"), stat = "identity", position = "dodge") +
  geom_bar(aes(y = max_speed, fill = "Maximum Speed"), stat = "identity", position = "dodge") +
  labs(title = "Broadband Speeds in Dorset by District", x = "District", y = "Speed (Mbps)") +
  scale_fill_manual(values = c("Average Speed" = "blue", "Maximum Speed" = "red")) +
  theme_minimal()
```
